
views/setup_default_start_point/show_languages.html.erb
        <%= render partial: 'shared/start_points_major_list' %>
views/shared/start_points_major_list.html.erb

  <% @start_points.major_names.each_with_index do |major_name, index| %>
    <div class="filename"
         id="major_<%= index %>"
         data-major="<%= major_name %>"
         data-index="<%= index %>"
         data-minor-index="<%= @start_points.minor_indexes[index][0] %>">
      <%= major_name %>
    </div>
  <% end %>
  //Each major-name has a minor-index which records which minor-entry
  //is currently displayed for that major-index. JS on the browser
  //ensures if you move from major-name to major-name it remembers
  //which minor-name each major-name was on and restores it.

  <% @start_points.minor_names.each_with_index do |minor_name,index| %>
    <div class="filename"
         id="minor_<%= index %>"
	       data-index="<%= index %>"
         data-minor="<%= minor_name %>">
      <%= minor_name %>
    </div>
  <% end %>
  //This is a list of _all_ minor-names. JS on the browser hides
  //them all and shows the appropriate entries for a major-name
  //when a major-name is selected.

From controller
    languages_names = display_names_of(languages)
    kata = storer.kata_exists?(id) ? dojo.katas[id] : nil
    index = choose_language(languages_names, kata)
    @start_points = ::DisplayNamesSplitter.new(languages_names, index)

  def display_names_of(start_points)
    start_points.map(&:display_name).sort
  end

  def choose_language(languages, kata)
    chooser(languages, kata) { kata.display_name }
  end

  def chooser(choices, kata)
    choice = [*0...choices.length].sample
    unless kata.nil?
      index = choices.index(yield)
      choice = index unless index.nil?
    end
    choice
  end

See also app/lib/display_names_splitter.rb
for DisplayNamesSplitter
